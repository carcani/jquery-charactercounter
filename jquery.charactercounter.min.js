!function(r){function a(t,n){this.options=null,this.$inputElement=null,this.$counterElement=null,this.init(t,n)}a.DEFAULTS={elementClass:"character-counter",validClass:"character-counter-valid",invalidClass:"character-counter-invalid",maxChars:1/0,minChars:0,counterElement:null,positiveOverruns:!1,newLinesAsTwoChars:!0,postCountMessage:null,preCountMessage:null,postCountMessageSingular:null,preCountMessageSingular:null,zeroRemainingMessage:null,overrunPostCountMessage:null,overrunPreCountMessage:null,overrunPostCountMessageSingular:null,overrunPreCountMessageSingular:null},a.prototype.init=function(t,n){this.$inputElement=r(t),this.options=r.extend({},a.DEFAULTS,n,this.getDataOptions()),null===this.options.counterElement?(this.$counterElement=r(document.createElement("div")),this.$inputElement.after(this.$counterElement)):this.$counterElement=r(this.options.counterElement),this.$counterElement.addClass(this.options.elementClass),this._onInput();t=this.getEventNames().join(" ");this.$inputElement.bind(t,r.proxy(this._onInput,this))},a.prototype.getEventNames=function(){var t=["change","keyup"];return"oninput"in document.createElement("input")&&t.push("input"),t},a.prototype.getDataOptions=function(){for(var t=Object.keys(a.DEFAULTS),n={},e=0;e<t.length;e++){var s=this.$inputElement.data(t[e]);void 0!==s&&(n[t[e]]=s)}return n},a.prototype.isValid=function(){var t=this.countCharactersUsed();return 0<=this.options.maxChars-t&&t>=this.options.minChars},a.prototype.getOption=function(t){return this.options[t]},a.prototype.countCharactersUsed=function(){var t=this.$inputElement.val(),n=t.length,t=t.match(/(\r\n|\n|\r)/g),e=0;return n+(e=null!=t?t.length:e)},a.prototype._onInput=function(){var t=this.isValid(),n=this.countCharactersUsed(),e=this.options.maxChars-n,n=this.calculateMessage(n,e);this.setText(n),this.setValidityClass(t)},a.prototype.calculateMessage=function(t,n){var e="",s="";return 0===n&&null!==this.options.zeroRemainingMessage?this.options.zeroRemainingMessage:(0<=n&&null!==this.options.preCountMessage?(e=this.options.preCountMessage,1===n&&null!==this.options.preCountMessageSingular&&(e=this.options.preCountMessageSingular)):n<0&&null!==this.options.overrunPreCountMessage&&(e=this.options.overrunPreCountMessage,-1===n)&&null!==this.options.overrunPreCountMessageSingular&&(e=this.options.overrunPreCountMessageSingular),0<=n&&null!==this.options.postCountMessage?(s=this.options.postCountMessage,1===n&&null!==this.options.postCountMessageSingular&&(s=this.options.postCountMessageSingular)):n<0&&null!==this.options.overrunPostCountMessage&&(s=this.options.overrunPostCountMessage,-1===n)&&null!==this.options.overrunPostCountMessageSingular&&(s=this.options.overrunPostCountMessageSingular),n<0&&this.options.positiveOverruns&&(n*=-1),0<e.length&&(e+=" "),e+n+(s=0<s.length?" "+s:s))},a.prototype.setText=function(t){this.$counterElement.text(t)},a.prototype.setValidityClass=function(t){t?this.$counterElement.addClass(this.options.validClass).removeClass(this.options.invalidClass):this.$counterElement.addClass(this.options.invalidClass).removeClass(this.options.validClass)},r.fn.characterCounter=function(e){function n(t){var t=r(t),n=t.data("markembling.characterCounter");return n||(n=new a(t,"object"==typeof e&&e),t.data("markembling.characterCounter",n)),n}var s,o,i;return"string"==typeof e?(s=e,o=Array.prototype.slice.call(arguments,1),this.each(function(){var t=n(this);if("function"!=typeof t[s])throw new Error("No function named "+s+" exists.");i=t[s](o)}),void 0!==i?i:this):this.each(function(){n(this)})}}(jQuery);